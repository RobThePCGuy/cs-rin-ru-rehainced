<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
    function showConfigPage() {
        $("#configButton").hide();
        $("#wholeWindow").show();
    }
    function sendConfig() {
        var data = {
            "script_enabled": $("#script_enabled")[0].checked,
            "infinite_scrolling": $("#infinite_scrolling")[0].checked,
            "mentioning": $("#mentioning")[0].checked,
            "dynamic_who_is_online": $("#dynamic_who_is_online")[0].checked,
            "dynamic_time": $("#dynamic_time")[0].checked,
            "display_ajax_loader": $("#display_ajax_loader")[0].checked,
            "custom_tags": $("#custom_tags")[0].checked,
            "hide_scs": Number($("#hide_scs")[0].value),
            "apply_in_scs": $("#apply_in_scs")[0].checked
        };
        window.postMessage(JSON.stringify(data), "*");
        configWindowClose();
        window.location.reload();
    }
    function configWindowClose() {
        $("#wholeWindow").hide();
        $("#configButton").show();
    }
    function enableScript() {
        if ($("input#script_enabled")[0].checked) {
            $("fieldset#config").slideDown();
        } else {
            $("fieldset#config").slideUp();
        }
    }
</script>
<style>
    /* fallback */
    @font-face {
        font-family: 'Material Icons';
        font-style: normal;
        font-weight: 400;
        src: url(https://fonts.gstatic.com/s/materialicons/v85/flUhRq6tzZclQEJ-Vdg-IuiaDsNc.woff2) format('woff2');
    }

    .material-icons {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px;
        line-height: 1;
        letter-spacing: normal;
        text-transform: none;
        display: inline-block;
        white-space: nowrap;
        word-wrap: normal;
        direction: ltr;
        -moz-font-feature-settings: 'liga';
        font-feature-settings: 'liga';
        -moz-osx-font-smoothing: grayscale;
    }

    #wholeWindow {
        display: none;
        position: absolute;
        top: 0px;
        left: 0px;
        width: 100%;
        height: 100%;
        background-color: rgba(128, 128, 128, 0.5);
        backdrop-filter: blur(10px);
        color: black;
    }

    #configWindow {
        position: absolute;
        top: 50%;
        left: 50%;
        padding: 5px;
        transform: translate(-50%, -50%);
        background-color: darkgray;
        border: solid 1px black;
        border-radius: 5px;
    }

    fieldset {
        padding: 2px;
        border-radius: 5px;
    }

    #buttons {
        margin-top: 5px;
        text-align: right;
    }

    #configButton {
        position: fixed;
        top: 5px;
        right: 5px;
        cursor: pointer;
    }
</style>
<div id="wholeWindow">
    <div id="configWindow">
        <fieldset>
            <legend>CS.RIN.RU Enhanced Configuration</legend>
            <table>
                <tr colspan="2">
                    <td>
                        <input type="checkbox" id="script_enabled" onclick="enableScript();"></input>
                        <label for="script_enabled">Enable script</label>
                    </td>
                </tr>
            </table>
            <fieldset id="config">
                <table>
                    <tr>
                        <td>
                            <input type="checkbox" id="infinite_scrolling"></input>
                            <label for="infinite_scrolling">Infinite scrolling</label>
                        </td>
                        <td>
                            <input type="checkbox" id="mentioning"></input>
                            <label for="mentioning">Mentioning</label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input type="checkbox" id="dynamic_who_is_online"></input>
                            <label for="dynamic_who_is_online">Dynamic who-is-online</label>
                        </td>
                        <td>
                            <input type="checkbox" id="dynamic_time"></input>
                            <label for="dynamic_time">Dynamic time</label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input type="checkbox" id="display_ajax_loader"></input>
                            <label for="display_ajax_loader">Display Ajax loader</label>
                        </td>
                        <td>
                            <input type="checkbox" id="custom_tags"></input>
                            <label for="custom_tags">Custom tags</label>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label for="hide_scs">Hide SCS</label>
                            <select id="hide_scs">
                                <option value="0">not hide</option>
                                <option value="1">hide all</option>
                                <option value="2">hide only green</option>
                                <option value="3">show only red</option>
                            </select>
                        </td>
                        <td>
                            <input type="checkbox" id="apply_in_scs"></input>
                            <label for="apply_in_scs">Apply also in SCS</label>
                        </td>
                    </tr>
                </table>
            </fieldset>
        </fieldset>
        <div id="buttons">
            <button onclick="sendConfig();">OK</button>
            <button onclick="configWindowClose();">Cancel</button>
        </div>
    </div>
</div>
<div id="configButton">
    <span class="material-icons" onclick="showConfigPage();" title="CS.RIN.RU Enhanced configuration">settings</span>
</div>
